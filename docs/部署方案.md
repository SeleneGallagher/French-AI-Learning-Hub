# ğŸš€ éƒ¨ç½²æ–¹æ¡ˆæŒ‡å—

ç”±äº Vercel å…è´¹è®¡åˆ’å­˜åœ¨é™åˆ¶ï¼ˆå‡½æ•°æ‰§è¡Œæ—¶é—´ã€å¸¦å®½ã€éƒ¨ç½²æ¬¡æ•°ç­‰ï¼‰ï¼Œæœ¬æ–‡æ¡£æä¾›å¤šç§æ›¿ä»£éƒ¨ç½²æ–¹æ¡ˆã€‚

## ğŸ“‹ Vercel é™åˆ¶è¯´æ˜

### Hobbyï¼ˆå…è´¹ï¼‰å¥—é¤é™åˆ¶
- **å‡½æ•°æ‰§è¡Œæ—¶é—´**ï¼šæœ€å¤š 10 ç§’
- **å‡½æ•°æ•°é‡**ï¼šæœ€å¤š 12 ä¸ª Serverless Functions
- **å¸¦å®½**ï¼š100GB/æœˆ
- **éƒ¨ç½²æ¬¡æ•°**ï¼šæ— é™åˆ¶ï¼ˆä½†å¯èƒ½å› å…¶ä»–é™åˆ¶å¯¼è‡´å¤±è´¥ï¼‰
- **æ–‡ä»¶å¤§å°**ï¼šå•æ–‡ä»¶æœ€å¤§ 50MB

### å¸¸è§é—®é¢˜
1. **å‡½æ•°è¶…æ—¶**ï¼šAI æ¥å£è°ƒç”¨å¯èƒ½è¶…è¿‡ 10 ç§’
2. **å¸¦å®½è€—å°½**ï¼šå¤§é‡é™æ€èµ„æºè®¿é—®
3. **å†·å¯åŠ¨æ…¢**ï¼šServerless å‡½æ•°é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿ

---

## ğŸ¯ æ¨èæ›¿ä»£æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šRailwayï¼ˆæ¨èï¼‰â­

**ä¼˜ç‚¹**ï¼š
- å…è´¹é¢åº¦ï¼š$5/æœˆï¼ˆè¶³å¤Ÿå°é¡¹ç›®ä½¿ç”¨ï¼‰
- æ”¯æŒ Flask åº”ç”¨
- è‡ªåŠ¨éƒ¨ç½²
- æ— å‡½æ•°æ‰§è¡Œæ—¶é—´é™åˆ¶
- å›½å†…è®¿é—®é€Ÿåº¦è¾ƒå¥½

**éƒ¨ç½²æ­¥éª¤**ï¼š

1. **æ³¨å†Œ Railway**
   - è®¿é—® https://railway.app
   - ä½¿ç”¨ GitHub è´¦å·ç™»å½•

2. **åˆ›å»ºæ–°é¡¹ç›®**
   ```bash
   # å®‰è£… Railway CLI
   npm i -g @railway/cli
   
   # ç™»å½•
   railway login
   
   # åˆå§‹åŒ–é¡¹ç›®
   railway init
   ```

3. **é…ç½®ç¯å¢ƒå˜é‡**
   - åœ¨ Railway Dashboard ä¸­è®¾ç½®æ‰€æœ‰ç¯å¢ƒå˜é‡
   - å‚è€ƒ `.env.example` æˆ– `config.example.js`

4. **åˆ›å»º `Procfile`**
   ```bash
   web: gunicorn app:app --bind 0.0.0.0:$PORT
   ```

5. **åˆ›å»º `runtime.txt`**ï¼ˆæŒ‡å®š Python ç‰ˆæœ¬ï¼‰
   ```
   python-3.11
   ```

6. **éƒ¨ç½²**
   ```bash
   railway up
   ```

---

### æ–¹æ¡ˆ 2ï¼šRender

**ä¼˜ç‚¹**ï¼š
- å…è´¹å¥—é¤å¯ç”¨ï¼ˆæœ‰ä¼‘çœ é™åˆ¶ï¼‰
- æ”¯æŒ Flask
- è‡ªåŠ¨éƒ¨ç½²
- ç®€å•æ˜“ç”¨

**éƒ¨ç½²æ­¥éª¤**ï¼š

1. **æ³¨å†Œ Render**
   - è®¿é—® https://render.com
   - ä½¿ç”¨ GitHub è´¦å·ç™»å½•

2. **åˆ›å»º Web Service**
   - è¿æ¥ GitHub ä»“åº“
   - é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•

3. **é…ç½®**
   - **Build Command**: `pip install -r requirements_server.txt`
   - **Start Command**: `gunicorn app:app`
   - **Environment**: Python 3

4. **è®¾ç½®ç¯å¢ƒå˜é‡**
   - åœ¨ Environment Variables ä¸­æ·»åŠ æ‰€æœ‰éœ€è¦çš„å˜é‡

5. **éƒ¨ç½²**
   - ç‚¹å‡» "Create Web Service" è‡ªåŠ¨éƒ¨ç½²

---

### æ–¹æ¡ˆ 3ï¼šFly.io

**ä¼˜ç‚¹**ï¼š
- å…è´¹é¢åº¦ï¼š3 ä¸ªå…±äº« CPU å®ä¾‹
- å…¨çƒè¾¹ç¼˜éƒ¨ç½²
- æ”¯æŒ Docker

**éƒ¨ç½²æ­¥éª¤**ï¼š

1. **å®‰è£… Fly CLI**
   ```bash
   # Windows (PowerShell)
   iwr https://fly.io/install.ps1 -useb | iex
   
   # Mac/Linux
   curl -L https://fly.io/install.sh | sh
   ```

2. **ç™»å½•**
   ```bash
   fly auth login
   ```

3. **åˆå§‹åŒ–**
   ```bash
   fly launch
   ```

4. **é…ç½® `fly.toml`**
   ```toml
   app = "your-app-name"
   primary_region = "hkg"  # é¦™æ¸¯ï¼Œå›½å†…è®¿é—®å¿«
   
   [build]
   
   [http_service]
     internal_port = 5000
     force_https = true
     auto_stop_machines = true
     auto_start_machines = true
     min_machines_running = 0
   
   [[services]]
     processes = ["app"]
     http_checks = []
     internal_port = 5000
     protocol = "tcp"
   ```

5. **éƒ¨ç½²**
   ```bash
   fly deploy
   ```

---

### æ–¹æ¡ˆ 4ï¼šå›½å†…äº‘æœåŠ¡å™¨ï¼ˆæ¨èå›½å†…ç”¨æˆ·ï¼‰â­

**ä¼˜ç‚¹**ï¼š
- å®Œå…¨æ§åˆ¶
- æ— é™åˆ¶
- å›½å†…è®¿é—®é€Ÿåº¦å¿«
- æˆæœ¬å¯æ§ï¼ˆå­¦ç”Ÿä¼˜æƒ ï¼‰

**æ¨èå¹³å°**ï¼š
- **é˜¿é‡Œäº‘**ï¼šå­¦ç”Ÿä¼˜æƒ  9.5 å…ƒ/æœˆ
- **è…¾è®¯äº‘**ï¼šå­¦ç”Ÿä¼˜æƒ  10 å…ƒ/æœˆ
- **åä¸ºäº‘**ï¼šå­¦ç”Ÿä¼˜æƒ 
- **UCloud**ï¼šä»·æ ¼ä¾¿å®œ

**éƒ¨ç½²æ­¥éª¤**ï¼š

1. **è´­ä¹°æœåŠ¡å™¨**
   - é€‰æ‹© Ubuntu 20.04 æˆ– 22.04
   - æœ€ä½é…ç½®ï¼š1æ ¸2Gï¼ˆè¶³å¤Ÿä½¿ç”¨ï¼‰

2. **æœåŠ¡å™¨é…ç½®**
   ```bash
   # æ›´æ–°ç³»ç»Ÿ
   sudo apt update && sudo apt upgrade -y
   
   # å®‰è£… Python 3.11
   sudo apt install python3.11 python3.11-venv python3-pip nginx -y
   
   # å®‰è£… Node.jsï¼ˆå¦‚æœéœ€è¦ï¼‰
   curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
   sudo apt install -y nodejs
   ```

3. **éƒ¨ç½²åº”ç”¨**
   ```bash
   # å…‹éš†é¡¹ç›®
   cd /var/www
   git clone <your-repo-url> AI_LL
   cd AI_LL
   
   # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
   python3.11 -m venv venv
   source venv/bin/activate
   
   # å®‰è£…ä¾èµ–
   pip install -r requirements_server.txt
   
   # é…ç½®ç¯å¢ƒå˜é‡
   cp .env.example .env
   nano .env  # ç¼–è¾‘ç¯å¢ƒå˜é‡
   ```

4. **é…ç½® Gunicorn**
   ```bash
   # åˆ›å»º systemd æœåŠ¡
   sudo nano /etc/systemd/system/french-ai.service
   ```
   
   å†…å®¹ï¼š
   ```ini
   [Unit]
   Description=French AI Learning Hub
   After=network.target
   
   [Service]
   User=www-data
   Group=www-data
   WorkingDirectory=/var/www/AI_LL
   Environment="PATH=/var/www/AI_LL/venv/bin"
   ExecStart=/var/www/AI_LL/venv/bin/gunicorn app:app --bind 127.0.0.1:5000 --workers 2
   
   [Install]
   WantedBy=multi-user.target
   ```
   
   ```bash
   # å¯åŠ¨æœåŠ¡
   sudo systemctl daemon-reload
   sudo systemctl enable french-ai
   sudo systemctl start french-ai
   ```

5. **é…ç½® Nginx**
   ```bash
   sudo nano /etc/nginx/sites-available/french-ai
   ```
   
   å†…å®¹ï¼š
   ```nginx
   server {
       listen 80;
       server_name your-domain.com;  # æˆ–æœåŠ¡å™¨IP
       
       # é™æ€æ–‡ä»¶
       location / {
           root /var/www/AI_LL;
           try_files $uri $uri/ /index.html;
       }
       
       location /public {
           alias /var/www/AI_LL/public;
       }
       
       # API ä»£ç†
       location /api {
           proxy_pass http://127.0.0.1:5000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
   }
   ```
   
   ```bash
   # å¯ç”¨é…ç½®
   sudo ln -s /etc/nginx/sites-available/french-ai /etc/nginx/sites-enabled/
   sudo nginx -t
   sudo systemctl restart nginx
   ```

6. **é…ç½® SSLï¼ˆå¯é€‰ä½†æ¨èï¼‰**
   ```bash
   sudo apt install certbot python3-certbot-nginx
   sudo certbot --nginx -d your-domain.com
   ```

---

### æ–¹æ¡ˆ 5ï¼šDocker + ä»»æ„å¹³å°

**ä¼˜ç‚¹**ï¼š
- ç¯å¢ƒä¸€è‡´
- æ˜“äºè¿ç§»
- æ”¯æŒå¤šç§å¹³å°

**åˆ›å»º Dockerfile**ï¼š
```dockerfile
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…ä¾èµ–
COPY requirements_server.txt .
RUN pip install --no-cache-dir -r requirements_server.txt

# å¤åˆ¶åº”ç”¨
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 5000

# å¯åŠ¨å‘½ä»¤
CMD ["gunicorn", "app:app", "--bind", "0.0.0.0:5000", "--workers", "2"]
```

**éƒ¨ç½²åˆ°ä»»æ„æ”¯æŒ Docker çš„å¹³å°**ï¼š
- Railway
- Render
- Fly.io
- äº‘æœåŠ¡å™¨
- Docker Hub + äº‘æœåŠ¡

---

## ğŸ”§ è¿ç§»æ£€æŸ¥æ¸…å•

### å‰ç«¯é…ç½®ä¿®æ”¹

å¦‚æœåç«¯ API åœ°å€æ”¹å˜ï¼Œéœ€è¦ä¿®æ”¹å‰ç«¯é…ç½®ï¼š

1. **ä¿®æ”¹ `scripts/services/apiService.js`**
   ```javascript
   // ä» Vercel ç¯å¢ƒå˜é‡æˆ–é…ç½®ä¸­è¯»å–
   const API_BASE_URL = process.env.API_BASE_URL || 'https://your-new-backend.com';
   ```

2. **æˆ–è€…ä½¿ç”¨ç¯å¢ƒå˜é‡**
   - åœ¨éƒ¨ç½²å¹³å°è®¾ç½® `API_BASE_URL`
   - å‰ç«¯é€šè¿‡é…ç½®è¯»å–

### ç¯å¢ƒå˜é‡è¿ç§»

ç¡®ä¿ä»¥ä¸‹ç¯å¢ƒå˜é‡åœ¨æ–°å¹³å°æ­£ç¡®é…ç½®ï¼š

**å¿…éœ€å˜é‡ï¼š**
- `DATABASE_URL` - PostgreSQL æ•°æ®åº“è¿æ¥ URL
- `JWT_SECRET` - JWT ç­¾åå¯†é’¥

**å¯é€‰å˜é‡ï¼š**
- `COZE_BOT_ID`
- `COZE_PAT_TOKEN` æˆ– `COZE_SAT_TOKEN`
- `DEEPSEEK_API_KEY`
- `TMDB_API_KEY`

### é™æ€æ–‡ä»¶å¤„ç†

å¦‚æœé™æ€æ–‡ä»¶è¾ƒå¤§ï¼ˆå¦‚è¯å…¸æ–‡ä»¶ï¼‰ï¼Œå»ºè®®ï¼š

1. **ä½¿ç”¨ CDN**ï¼ˆå¦‚ Cloudflareã€é˜¿é‡Œäº‘ OSSï¼‰
2. **ä½¿ç”¨å¯¹è±¡å­˜å‚¨æœåŠ¡**ï¼ˆAWS S3ã€é˜¿é‡Œäº‘ OSSã€è…¾è®¯äº‘ COSã€Cloudflare R2ï¼‰
3. **ä½¿ç”¨ Git LFS**ï¼ˆå¯¹äºå¤§æ–‡ä»¶ç‰ˆæœ¬æ§åˆ¶ï¼‰

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | æˆæœ¬ | å›½å†…è®¿é—® | æ˜“ç”¨æ€§ | é™åˆ¶ | æ¨èåº¦ |
|------|------|----------|--------|------|--------|
| Railway | $5/æœˆå…è´¹é¢åº¦ | â­â­â­ | â­â­â­â­â­ | æ—  | â­â­â­â­â­ |
| Render | å…è´¹ï¼ˆæœ‰ä¼‘çœ ï¼‰ | â­â­ | â­â­â­â­ | ä¼‘çœ é™åˆ¶ | â­â­â­â­ |
| Fly.io | å…è´¹é¢åº¦ | â­â­â­ | â­â­â­ | 3ä¸ªå®ä¾‹ | â­â­â­â­ |
| å›½å†…äº‘æœåŠ¡å™¨ | 10-50å…ƒ/æœˆ | â­â­â­â­â­ | â­â­â­ | æ—  | â­â­â­â­â­ |
| Docker | å–å†³äºå¹³å° | å–å†³äºå¹³å° | â­â­â­ | å–å†³äºå¹³å° | â­â­â­â­ |

---

## ğŸš¨ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æµ‹è¯• Flask åº”ç”¨æ˜¯å¦æ­£å¸¸ï¼Ÿ
```bash
# æœ¬åœ°æµ‹è¯•
python app.py

# æˆ–ä½¿ç”¨ gunicorn
gunicorn app:app --bind 127.0.0.1:5000
```

### Q: é™æ€æ–‡ä»¶æ— æ³•è®¿é—®ï¼Ÿ
- ç¡®ä¿ Nginx é…ç½®æ­£ç¡®
- æ£€æŸ¥æ–‡ä»¶æƒé™ï¼š`sudo chown -R www-data:www-data /var/www/AI_LL`

### Q: API è¿”å› 404ï¼Ÿ
- æ£€æŸ¥è·¯ç”±é…ç½®
- ç¡®ä¿ Flask åº”ç”¨æ­£ç¡®å¤„ç† `/api/*` è·¯å¾„

### Q: CORS é”™è¯¯ï¼Ÿ
- ç¡®ä¿ Flask-CORS å·²å®‰è£…å¹¶é…ç½®
- æ£€æŸ¥ `app.py` ä¸­çš„ CORS è®¾ç½®

---

## ğŸ“ ä¸‹ä¸€æ­¥

1. **é€‰æ‹©é€‚åˆçš„æ–¹æ¡ˆ**ï¼ˆæ¨è Railway æˆ–å›½å†…äº‘æœåŠ¡å™¨ï¼‰
2. **æŒ‰ç…§æ­¥éª¤éƒ¨ç½²**
3. **æµ‹è¯•æ‰€æœ‰åŠŸèƒ½**
4. **æ›´æ–°å‰ç«¯ API åœ°å€**
5. **é…ç½®åŸŸåå’Œ SSL**

---

**æœ€åæ›´æ–°**ï¼š2024-12-19

