# ğŸš‚ Railway éƒ¨ç½²å®Œæ•´æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ ä¸€æ­¥æ­¥å°†é¡¹ç›®éƒ¨ç½²åˆ° Railwayã€‚

## ğŸ“‹ å‰ç½®è¦æ±‚

1. **GitHub è´¦å·**ï¼ˆç”¨äºç™»å½• Railwayï¼‰
2. **é¡¹ç›®å·²æ¨é€åˆ° GitHub**ï¼ˆRailway éœ€è¦ä» GitHub éƒ¨ç½²ï¼‰
3. **ç¯å¢ƒå˜é‡æ¸…å•**ï¼ˆè§ä¸‹æ–¹ï¼‰

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆ5åˆ†é’Ÿï¼‰

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Railway Dashboardï¼ˆæ¨èï¼‰

#### æ­¥éª¤ 1ï¼šæ³¨å†Œå¹¶ç™»å½• Railway

1. è®¿é—® https://railway.app
2. ç‚¹å‡» **"Start a New Project"**
3. é€‰æ‹© **"Login with GitHub"** ä½¿ç”¨ GitHub è´¦å·ç™»å½•
4. æˆæƒ Railway è®¿é—®ä½ çš„ GitHub ä»“åº“

#### æ­¥éª¤ 2ï¼šåˆ›å»ºæ–°é¡¹ç›®

1. ç‚¹å‡» **"New Project"**
2. é€‰æ‹© **"Deploy from GitHub repo"**
3. é€‰æ‹©ä½ çš„é¡¹ç›®ä»“åº“ï¼ˆAI_LLï¼‰
4. Railway ä¼šè‡ªåŠ¨æ£€æµ‹é¡¹ç›®ç±»å‹

#### æ­¥éª¤ 3ï¼šé…ç½®ç¯å¢ƒå˜é‡

åœ¨ Railway Dashboard ä¸­ï¼Œç‚¹å‡»é¡¹ç›® â†’ **Variables** æ ‡ç­¾ï¼Œæ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

**å¿…éœ€çš„ç¯å¢ƒå˜é‡ï¼š**
```
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_SECRET_KEY=your-service-role-key
```

**å¯é€‰çš„ç¯å¢ƒå˜é‡ï¼ˆæ ¹æ®ä½ çš„éœ€æ±‚æ·»åŠ ï¼‰ï¼š**
```
COZE_BOT_ID=your-bot-id
COZE_PAT_TOKEN=your-pat-token
DEEPSEEK_API_KEY=your-deepseek-key
TMDB_API_KEY=your-tmdb-key
JWT_SECRET=your-jwt-secret-key
```

#### æ­¥éª¤ 4ï¼šéƒ¨ç½²

1. Railway ä¼šè‡ªåŠ¨å¼€å§‹éƒ¨ç½²
2. ç­‰å¾…æ„å»ºå®Œæˆï¼ˆé€šå¸¸ 2-5 åˆ†é’Ÿï¼‰
3. éƒ¨ç½²æˆåŠŸåï¼ŒRailway ä¼šæä¾›ä¸€ä¸ªåŸŸåï¼Œæ ¼å¼å¦‚ï¼š`your-project.railway.app`

#### æ­¥éª¤ 5ï¼šé…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰

1. åœ¨é¡¹ç›®è®¾ç½®ä¸­æ‰¾åˆ° **Settings** â†’ **Domains**
2. ç‚¹å‡» **"Custom Domain"**
3. è¾“å…¥ä½ çš„åŸŸåï¼ˆå¦‚ `french-ai.example.com`ï¼‰
4. æŒ‰ç…§æç¤ºé…ç½® DNS è®°å½•

---

### æ–¹æ³•äºŒï¼šä½¿ç”¨ Railway CLI

#### æ­¥éª¤ 1ï¼šå®‰è£… Railway CLI

**Windows (PowerShell):**
```powershell
iwr https://railway.app/install.ps1 | iex
```

**Mac/Linux:**
```bash
curl -fsSL https://railway.app/install.sh | sh
```

**æˆ–ä½¿ç”¨ npm:**
```bash
npm install -g @railway/cli
```

#### æ­¥éª¤ 2ï¼šç™»å½•

```bash
railway login
```

#### æ­¥éª¤ 3ï¼šåˆå§‹åŒ–é¡¹ç›®

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
railway init
```

#### æ­¥éª¤ 4ï¼šè®¾ç½®ç¯å¢ƒå˜é‡

```bash
# è®¾ç½®å•ä¸ªå˜é‡
railway variables set SUPABASE_URL=https://xxxxx.supabase.co
railway variables set SUPABASE_SECRET_KEY=your-key

# æˆ–ä» .env æ–‡ä»¶å¯¼å…¥ï¼ˆæ¨èï¼‰
railway variables --file .env
```

#### æ­¥éª¤ 5ï¼šéƒ¨ç½²

```bash
railway up
```

#### æ­¥éª¤ 6ï¼šæŸ¥çœ‹æ—¥å¿—

```bash
railway logs
```

#### æ­¥éª¤ 7ï¼šæ‰“å¼€ç½‘ç«™

```bash
railway open
```

---

## ğŸ”§ ä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

### Windows ç”¨æˆ·

```bash
# åŒå‡»è¿è¡Œæˆ–åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ
scripts\deploy_railway.bat
```

### Linux/Mac ç”¨æˆ·

```bash
# æ·»åŠ æ‰§è¡Œæƒé™ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
chmod +x scripts/deploy_railway.sh

# è¿è¡Œè„šæœ¬
./scripts/deploy_railway.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. æ£€æŸ¥å¹¶å®‰è£… Railway CLI
2. å¼•å¯¼ä½ ç™»å½•
3. åˆå§‹åŒ–é¡¹ç›®
4. æç¤ºä½ è®¾ç½®ç¯å¢ƒå˜é‡
5. å¼€å§‹éƒ¨ç½²

---

## ğŸ“ ç¯å¢ƒå˜é‡è¯¦ç»†è¯´æ˜

### å¿…éœ€å˜é‡

| å˜é‡å | è¯´æ˜ | è·å–æ–¹å¼ |
|--------|------|----------|
| `SUPABASE_URL` | Supabase é¡¹ç›® URL | Supabase Dashboard â†’ Settings â†’ API |
| `SUPABASE_SECRET_KEY` | Supabase Service Role Key | Supabase Dashboard â†’ Settings â†’ API â†’ service_role key |

### å¯é€‰å˜é‡

| å˜é‡å | è¯´æ˜ | è·å–æ–¹å¼ |
|--------|------|----------|
| `COZE_BOT_ID` | Coze æœºå™¨äºº ID | Coze å¹³å° â†’ æœºå™¨äººè®¾ç½® |
| `COZE_PAT_TOKEN` | Coze è®¿é—®ä»¤ç‰Œ | Coze å¹³å° â†’ å¼€å‘è€…è®¾ç½® |
| `DEEPSEEK_API_KEY` | DeepSeek API å¯†é’¥ | https://platform.deepseek.com/api_keys |
| `TMDB_API_KEY` | TMDB API å¯†é’¥ | https://www.themoviedb.org/settings/api |
| `JWT_SECRET` | JWT ç­¾åå¯†é’¥ï¼ˆç”¨äºè®¤è¯ï¼‰ | è‡ªè¡Œç”Ÿæˆï¼ˆéšæœºå­—ç¬¦ä¸²ï¼‰ |

### ç”Ÿæˆ JWT_SECRETï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
# Linux/Mac
openssl rand -hex 32

# Windows (PowerShell)
-join ((48..57) + (65..90) + (97..122) | Get-Random -Count 32 | ForEach-Object {[char]$_})
```

---

## ğŸ¯ éƒ¨ç½²åæ£€æŸ¥æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

- [ ] è®¿é—® `/health` ç«¯ç‚¹ï¼Œåº”è¯¥è¿”å› `{"status": "ok"}`
- [ ] è®¿é—® `/api/config` ç«¯ç‚¹ï¼Œæ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®
- [ ] æµ‹è¯•ç™»å½•åŠŸèƒ½ï¼ˆå¦‚æœé…ç½®äº†è®¤è¯ï¼‰
- [ ] æµ‹è¯• AI åŠ©æ‰‹åŠŸèƒ½ï¼ˆå¦‚æœé…ç½®äº† Cozeï¼‰
- [ ] æ£€æŸ¥é™æ€æ–‡ä»¶æ˜¯å¦æ­£å¸¸åŠ è½½
- [ ] æŸ¥çœ‹ Railway æ—¥å¿—ï¼Œç¡®è®¤æ²¡æœ‰é”™è¯¯

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: éƒ¨ç½²å¤±è´¥ï¼Œæç¤º "Build failed"

**å¯èƒ½åŸå› ï¼š**
- Python ç‰ˆæœ¬ä¸åŒ¹é…
- ä¾èµ–å®‰è£…å¤±è´¥
- ä»£ç è¯­æ³•é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ `runtime.txt` ä¸­çš„ Python ç‰ˆæœ¬ï¼ˆåº”è¯¥æ˜¯ `python-3.11`ï¼‰
2. æ£€æŸ¥ `requirements_server.txt` ä¸­çš„ä¾èµ–æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹ Railway æ„å»ºæ—¥å¿—ï¼Œæ‰¾åˆ°å…·ä½“é”™è¯¯

### Q2: åº”ç”¨å¯åŠ¨åç«‹å³å´©æºƒ

**å¯èƒ½åŸå› ï¼š**
- ç¯å¢ƒå˜é‡æœªè®¾ç½®
- ç«¯å£é…ç½®é”™è¯¯
- æ•°æ®åº“è¿æ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥æ‰€æœ‰å¿…éœ€çš„ç¯å¢ƒå˜é‡æ˜¯å¦å·²è®¾ç½®
2. ç¡®è®¤ `Procfile` ä¸­ä½¿ç”¨ `$PORT` å˜é‡ï¼ˆRailway ä¼šè‡ªåŠ¨æ³¨å…¥ï¼‰
3. æŸ¥çœ‹æ—¥å¿—ï¼š`railway logs`

### Q3: API è¿”å› 404

**å¯èƒ½åŸå› ï¼š**
- è·¯ç”±é…ç½®é”™è¯¯
- é™æ€æ–‡ä»¶è·¯ç”±å†²çª

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ `app.py` ä¸­çš„è·¯ç”±é…ç½®
2. ç¡®è®¤ API è·¯å¾„ä»¥ `/api/` å¼€å¤´
3. æµ‹è¯• `/health` ç«¯ç‚¹æ˜¯å¦æ­£å¸¸

### Q4: é™æ€æ–‡ä»¶æ— æ³•åŠ è½½

**å¯èƒ½åŸå› ï¼š**
- Flask é™æ€æ–‡ä»¶é…ç½®é—®é¢˜
- æ–‡ä»¶è·¯å¾„é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ `app.py` ä¸­çš„ `static_folder` é…ç½®
2. ç¡®è®¤æ–‡ä»¶å­˜åœ¨äºæ­£ç¡®è·¯å¾„
3. è€ƒè™‘ä½¿ç”¨ CDN æˆ–å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚ Supabase Storageï¼‰

### Q5: å¦‚ä½•æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼Ÿ

```bash
railway logs --follow
```

### Q6: å¦‚ä½•é‡å¯æœåŠ¡ï¼Ÿ

åœ¨ Railway Dashboard ä¸­ï¼š
1. è¿›å…¥é¡¹ç›®
2. ç‚¹å‡»æœåŠ¡
3. ç‚¹å‡» **"Restart"** æŒ‰é’®

æˆ–ä½¿ç”¨ CLIï¼š
```bash
railway restart
```

### Q7: å¦‚ä½•æ›´æ–°ä»£ç ï¼Ÿ

Railway æ”¯æŒè‡ªåŠ¨éƒ¨ç½²ï¼š
1. æ¨é€ä»£ç åˆ° GitHub
2. Railway ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶é‡æ–°éƒ¨ç½²

æˆ–æ‰‹åŠ¨è§¦å‘ï¼š
```bash
git push
railway up
```

---

## ğŸ’° Railway å®šä»·

### Hobby å¥—é¤ï¼ˆå…è´¹é¢åº¦ï¼‰

- **$5/æœˆå…è´¹é¢åº¦**
- è¶³å¤Ÿå°åˆ°ä¸­å‹é¡¹ç›®ä½¿ç”¨
- è¶…å‡ºåæŒ‰ä½¿ç”¨é‡ä»˜è´¹

### æŸ¥çœ‹ä½¿ç”¨é‡

åœ¨ Railway Dashboard â†’ **Usage** æŸ¥çœ‹å½“å‰ä½¿ç”¨æƒ…å†µã€‚

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¸è¦æäº¤æ•æ„Ÿä¿¡æ¯**
   - ç¡®ä¿ `.env` æ–‡ä»¶åœ¨ `.gitignore` ä¸­
   - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥

2. **ä½¿ç”¨ç¯å¢ƒå˜é‡**
   - æ‰€æœ‰æ•æ„Ÿé…ç½®éƒ½é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®

3. **å®šæœŸæ›´æ–°ä¾èµ–**
   - å®šæœŸè¿è¡Œ `pip install --upgrade -r requirements_server.txt`

---

## ğŸ“š ç›¸å…³èµ„æº

- [Railway å®˜æ–¹æ–‡æ¡£](https://docs.railway.app)
- [Railway Discord ç¤¾åŒº](https://discord.gg/railway)
- [é¡¹ç›®éƒ¨ç½²æ–¹æ¡ˆæ€»è§ˆ](./éƒ¨ç½²æ–¹æ¡ˆ.md)

---

## ğŸ‰ éƒ¨ç½²æˆåŠŸï¼

éƒ¨ç½²å®Œæˆåï¼Œä½ çš„åº”ç”¨å°†è¿è¡Œåœ¨ï¼š
- **Railway æä¾›çš„åŸŸå**ï¼š`https://your-project.railway.app`
- **è‡ªå®šä¹‰åŸŸå**ï¼ˆå¦‚æœé…ç½®äº†ï¼‰ï¼š`https://your-domain.com`

**ä¸‹ä¸€æ­¥ï¼š**
1. æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
2. é…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰
3. è®¾ç½®ç›‘æ§å’Œå‘Šè­¦ï¼ˆå¯é€‰ï¼‰

---

**æœ€åæ›´æ–°**ï¼š2024-12-19

